language: go
go:
- 1.3
env: PATH=/home/travis/gopath/bin:$PATH
install:
- sudo apt-get update
- DEBIAN_FRONTEND=noninteractive sudo apt-get install -y rpm devscripts debhelper
#- mkdir -p ~/rpmbuild/{BUILD,BUILDROOT,RPMS,SOURCES,SPECS,SRPMS}
script:
- make all
- make crossbuild
deploy:
  provider: releases
  api_key:
    secure: C2tHKZgheh9hg75058Y3084n1LBT3sfxHzFvPqFws3MemsyKfNyn2o9+9f3ne7NdQ+Ai+8q4j8xFG7Wa5IULvF7yGpynvycevDrI141xL964+2MnRddfceHc8ay62U6/lU4JRARJeSDswBx6KLoz6wmrz
  file:
  # - /home/travis/rpmbuild/RPMS/noarch/mackerel-agent-plugins-0.14.0-1.noarch.rpm
  # - /home/travis/gopath/src/github.com/mackerelio/mackerel-agent/packaging/mackerel-agent_0.14.0-1_all.deb
  - snapshot/mackerel-agent_darwin_386.zip
  - snapshot/mackerel-agent_freebsd_386.zip
  - snapshot/mackerel-agent_linux_386.tar.gz
  - snapshot/mackerel-agent_windows_386.zip
  skip_cleanup: true
  on:
    repo: mackerelio/mackerel-agent
    all_branches: true
    tags: true
notifications:
  slack:
    secure: n9Hs5rIlb6MuFVsRp46ykd+CptnE3boI7Q9mNLuHwz77IQ/2mpUmOyBRDeW3BA2EXa4WEYAXu8q7/b7zVV+c+RcPdz8/h9N9EBrHUVeIkCP/Nyp+aUA8GvLNjGuxYC7nov3L+9GHBFXKX8FaV2lZ1/Eeb1Ovbtv6Oi39xNkHqTQ=
